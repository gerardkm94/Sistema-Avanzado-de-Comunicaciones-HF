function rxBitsError = error_generator(systemParam,txBitsEncodedInterleaved,porcentaje_errores,rafaga,numero_rafagas)

%Este es el numero de bits erroneos en funcion de los bits detectados de
%entrada
numero_bits_erroneos = (length(txBitsEncodedInterleaved)*(porcentaje_errores/100));
txBitsEncodedInterleaved2 = txBitsEncodedInterleaved;

%Creamos una condicion para realizar la insercion de errores en rafaga o
%aleatoriamente

if strcmp(rafaga,'no') 
    %Condicional triple que separa los tipos de codificacion, lo podriamos
    %haber realizado sin el condicional, pero hemos decidido aleatorizar
    %los valores una vez y guardarlos en variables fijas para poder hacer
    %una comparativa 100% significativa.
    
    %Si queremos que el sistema genere valores aleatorios, se debe
    %descomentar la linea randompos.
    if strcmp(systemParam.coding.type,'fast')
    %randomPos = randperm(length(txBitsEncodedInterleaved),round(numero_bits_erroneos)); %genera un numero aleatorio SIN REPETICION (será la posicion a alterrar el valor)   
    randomPosfast = [562 1496 484 149 603 840 1513 1355 293 404 292 663 399 325 497 1295 1486 1250 882 949 268 332 283 718 69 197 622 1385 1141 915 211 1392 244 1116 395 504 187 714 1327 312 890 92 605 905 1361 912 575 711 903 1243 983 16 881 1168 44 971 966 1446 734 1443 1029 1183 392 72 1107 1078 1132 1473 567 1289 584 1467 1317 979 53 918 996 358 1030 88 152 118 107 548 1163 813 1022 1299 1077 1482 340 1326 509 666 263 460 490 365 278 17 1434 1301 1509 1278 645 884 1424 443 427 638 1423 587 48 477 1442 93 544 970 1437 58 1288 1162 1422 1258 506 1067 554 510 799 549 1038 1268 1453 730 1142 1560 1351 162 327 796 1108 858 902 1025 1475 724 942 1084 311 62 35 1540 1249 1226 1529 412 367 403 873 1224 1112 1055 1555 338 317 14 1342 1404 485 82 194 1276 1531 774 1173 704 75 703 1284 642 342 148 1439 1211 975 783 169 203 1246 1003 160 222 401 89 1339 1374 920 449 940 80 183 357 812 123 1343 843 1083 1345 681 919 32 1522 921 1461 96 1118 90 1304 1504 1510 1457 707 560 1379 1063 346 1283 744 683 192 308 924 1164 1282 1298 538 147 1445 797 328 1377 1523 1323 70 314 1001 1213 713 97 606 739 177 1315 630 166 435 375 3 1280 1154 323 875 1234 632 299 225 363 846 753 1095 145 1092 1547 828 1462 665 582 1550 95 374 537 706 303 1285 1448 1318 1098 133 938 1507 579 451 300 41 794 1056 948 555 1114 885 452 1071 1190 1309 977 144 1328 1463 618 1375 316 1346 1499 728 1120 586 419 839 963 150 1140 424 841 1203 1541 167 454 804 1259 853 50 1559 1398 343 227 1072 42 73 1000 779 982 1245 870 594 563 788 1247 935 836 1137 540 1433 1549 733 1526 306 611 378 1459 1417 507 369 907 1294 1360 104 447 1257 511 1401 820 767 541 1146 12 1188 1500 814 1007 953 1171 817 1034 634 802 1415 1169 368 1533 1104 499 1421 1051 27 652 1518 759 361 625 972 468 164 255 1241 138 668 1019 680 585 515 1497 411 1187 431 309 872 513 722 863 1450 1261 284 220 236 7 131 1544 553 400 158 1542 968 210 136 1330 822 1334 1184 1502 1053 617 252 429 276 1182 945 691 848 671 1350 1195 219 936 334 944 1009 806 355 657 922 1331 106 1080 163 825 539 1263 1134 151 1139 887 1303 994 142 557 1050 1321 1198 639 1032 581 1530 1396 1240 1200 682 997 667 1145 173 1215 1026 984 1296 512 129 1197 519 851 995 1277 126 648 807 1160 1012 591 1010 635 344 4 51 590 1292 441 491 1018 1336 914 823 45 1464 775 410 1319 470 955 859 889 1199 1222 899 958 438 204 824 360 422 304 11 952 1387 526 372 1490 390 769 1498 1111 991 275 1227 835 670 1521 190 844 1354 1220 298 1358 240 529 502 1236 1105 967 381 382 277 1208 565 1400 771 111 310 1394 965 1414 179 747 693 433 28 1150 612 387 726 1158 1406 600 1232 986 1511 1426 1167 46 291 766 257 530 865 182 1274 745 8 1 266 593 1489 628 1349 1429 755 901 923 1170 1432 649 1127 552 624 1202 120 1110 235 159 559 414 674 531 1117 487 1100 1217 209 999 535 1524 85 619 1225 458 1059 1516 1086 478 1005 1383 801 1130 878 1528 909 439 653 833 620 1229 883 18 249 1040 364 5 223 1233 397 524 67 534 818 1037 273 561 103 826 631 1438 1031 1344 932 437 1353 336 492 254 601 895 406 1451 1352 808 1218 36 23 102 827 181 463 393 473 1070 1231 763 349 125 637 1179 1436 224 929 61 1382 501 781 359 141 462 893 1425 37 888 621 684 52 113 250 78 350 721 238 1472 108 479 464 698 1341 176 650 1478 218 296 1367 676 486 1384 960 498 1395 850 289 456 989 1185 1159 1090 1364 673 1389 286 655 428 1408 1558 1471 1505 957 143 137 1201 643 954 659 1480 425 287 758 1365 396 324 941 937 520 699 215 465 1322 1307 1157 247 743 962 445 1517 521 1416 178 1060 613 1441 1181 221 1412 821 450 1147 1273 1474 1527 651 55 38 1174 135 810 886 956 1206 115 1556 876 1455 787 1099 595 694 1420 253 686 790 608 1348 725 326 1515 1096 262 121 1402 946 2 482 264 773 87 391 1020 1403 457 925 331 1290 480 208 1004 589 610 688 466 1006 233 1306 1230 385 212 1082 1314 1035 337 185 1539 536 1143 1543 1260 1262 572 798 897 815 679 1468 1216 1357 1266 751 1325 198 413 1320 20 689 1256 472 39 81 1418 494 279 1495 259 373 791 746 803 1534 1212 855 1161 354 1205 1376 770 990 1136 86 153 436 1373 345 101 819 1537 640 99 171 1430 132 1061 551 1380 1440 1269 542 623 110 951 432 1119 1047 63 1410 1036 1481 1013 380 969 116 216 1153 550 1293 597 1175 789 15 10 294 165 842 1407 517 228 599 1369 719 776 139 1017 862 31 1054 943 981 1316 430 54 189 351 205 398 1106 1126 1536 837 715 869 1305 1393 1091 1356 829 1255 421 1046 1458 735 1066 408 265 407 1477 647 993 736 274 1552 1015 26 1466 1538 1419 134 757 1135 754 687 964 1337 459 854 778 900 947 495 119 1052 749 1239 1553 157 91 723 696 47 933 592 762 1152 1221 1252 180 1409 206 1075 1064 1275 793 24 1333 65 370 405 272 629 777 426 800 295 987 1149 1133 243 1291 488 242 1514 1093 709 1520 1024 568 271 285 786 1381 59 1469 1313 1281 389 302 25 1129 415 866 1494 56 256 402 174 644 1210 122 1101 241 768 1488 931 518 481 29 434 1115 729 1308 1121 1176 1452 556 811 1399 1207 353 1431 988 756 260 1192 130 737 1081 772 446 1554 1235 1138 1501 9 1065 1109 752 678 1447 475 1128 1551 1058 741 448 847 523 6 66 705 660 453 57 1302 418 861 371 1123 710 60 641 114 237 805 832 664 77 423 1324 998 333 1043 94 383 908 1223 1074 109 186 1131 409 961 690 845 1270 906 913 476 1016 1044 830 809 950 1390 71 926 377 576 1027 261 362 258 161 1209 170 84 527 700 128 782 98 217 1483 1148 493 578 1076 596 1388 1125 1484 234 329 864 1368 761 471 1371 76 917 1465 1460 1271 852 1033 352 976 732 973 654 1228 1062 461 1378 213 831 313 49 1204 1049 100 867 1085 417 154 1535 30 297 742 910 1503 231 934 877 335 1311 574 1335 184 1219 1545 1428 959 282 1251 394 1476 974 246 662 280 79 21 1491 1011 1548 636 1532 196 894 928 838 571 1340 40 1508 348 1151 616 904 1279 1286 384 1248 1267 175 124 546 1214 1449 376 1397 570 879 1045 172 992 1165 580 1094 127 1156 1413 661 1359 503 199 34 22 633 1008 604 444 74 1178 1014 740 780 1287 1196 1122 533 614 442 1189 105 330 764 1312 765 978 1253 748 1363 627 1405 598 248 193 849 985 1493 712 1300 226 1254 500 321 420 1366 68 980 1194 1370 588 1519 1088 1264 1069 1310 566 347 1042 112 140 214 532 307 1089 916 816 785 860 1103 83 898 379 702 386 483 156 646 319 792 892 301 626 669 1002 1244 1272 1238 1079 1347 547 716 868 200 939 760 656 558 117 201 1386 695 341 795 267 1435 525 896 195 1362 1242 1427 1329 720 1073 1048 717 727 577 239 573 685 1391 232 1155 505 1557 188 1177 1265 440 738 1297 930 871 318 1546 784 269 516 1444 1087 602 64 880 1057 1456 1180 1144 474 508 911 455 731 1039 43 191 288 692 1191 315 564 1041 583 489 1492 388 416 1023 1172 677 1454 543 366 1068 13 1102 1506 19 750 1166 270 701 1186 522 146 168 1332 251 1479 528 856 1512 1097 615 1193 874 469 545 607 672 202 1470 305 245 1124 1411 1113 339 1485 1525 569 229 1487 514 697 1338 609 467 834 33 1237 281 857 322 891 230 356 1372 708 1028 658 927 290 496 207 675 320 1021 155];    
        for i=1:1:numero_bits_erroneos
            value = txBitsEncodedInterleaved(randomPosfast(i));
            if value == 0
                txBitsEncodedInterleaved2(randomPosfast(i))=1; % Si es un 0 le ponemos 1
            elseif value == 1
                txBitsEncodedInterleaved2(randomPosfast(i))=0; % Si es un 1 le ponemos 0
            else 
                txBitsEncodedInterleaved2(randomPosfast(i))=txBitsEncodedInterleaved(randomPos(i)); % Lo dejamos igual
            end
        end
        
    elseif strcmp(systemParam.coding.type,'slowWeak')
    randomPos = [341 75 4 748 43 989 1623 859 689 980 1218 28 1292 1356 82 264 1368 1261 1694 1723 629 401 1930 1801 1538 1948 1185 1253 107 1363 309 923 402 290 371 1038 1444 511 1564 9 796 825 1141 1848 1249 365 317 1284 581 1177 1475 1335 1596 1009 2028 1924 1131 1902 1778 1664 1831 1301 1140 918 1620 297 160 63 1506 509 1052 1588 1971 1945 815 60 1609 271 743 418 676 1757 1437 673 1160 1643 1347 81 334 1125 1850 897 912 975 227 2018 1644 789 1274 405 1193 1194 1029 21 703 835 681 1242 940 484 805 285 741 1380 1116 486 125 767 1917 580 102 1500 1806 1730 650 1028 332 1943 1006 1344 219 685 1531 872 438 315 1578 47 1811 919 1507 990 1826 896 310 1376 1327 1669 739 1100 754 1858 93 185 1662 229 300 37 463 695 1652 1200 1343 1888 308 1821 569 1442 508 24 74 1383 1878 573 557 19 1731 1124 792 1238 863 2014 626 1638 1629 1407 1939 14 1129 1981 364 787 567 173 1033 1062 998 1106 1671 765 85 1503 1149 1023 1767 1680 278 702 1844 87 1677 1104 1474 209 880 1818 1524 1338 1868 94 1210 2012 1390 1597 1525 564 763 1666 1951 773 1630 1871 1701 730 1560 1777 2030 1824 1558 575 1329 718 117 908 750 1724 1849 1217 126 1470 837 299 100 727 1595 2037 1082 1534 487 715 1315 704 1421 1300 433 1675 1656 1574 1272 1458 1708 1936 1957 678 795 1490 1398 3 2019 492 269 1119 1196 1972 1982 260 779 686 1117 1582 1682 1205 1683 283 848 72 1133 724 140 1653 1989 1876 1797 1467 1913 534 1065 843 404 1593 949 892 728 166 1938 753 882 1233 977 1173 1709 430 1789 725 1569 1785 829 280 1197 177 1544 1954 337 1551 1423 1414 1113 1309 1252 1665 1511 1201 1736 1812 1428 945 146 396 333 359 1389 995 1990 972 1999 1364 1911 118 469 1577 560 885 638 1614 1673 1753 775 1963 435 1839 1093 1738 1585 220 1288 224 693 91 1419 1267 614 619 600 1759 429 738 500 1642 831 1606 583 1698 231 874 485 36 397 1725 983 1234 884 461 263 709 1727 1810 1426 1002 770 1090 1905 1650 1586 376 1684 1700 481 403 1277 7 155 1769 800 1589 1215 679 736 1815 34 1587 357 1340 1412 1893 56 755 985 1061 1448 145 1563 928 1747 206 1965 938 475 1035 1533 132 671 88 1128 195 465 1661 1541 514 1322 762 83 599 448 1355 607 5 298 1214 1435 1057 1573 1441 630 1800 1526 169 846 869 624 240 345 1369 1857 1761 850 777 2016 1714 641 1053 525 259 1311 1095 1867 1279 1967 1101 1283 2005 1520 868 803 1024 90 119 1171 1241 1894 778 1207 1856 788 1479 150 1127 1400 204 781 1015 2046 1647 1332 328 1004 2008 2035 352 2048 387 1032 814 1760 1966 1887 1827 512 947 1294 1973 1 982 853 632 1118 135 70 246 1107 325 157 1270 554 1791 942 1720 54 1875 603 577 1321 1229 1892 50 976 1318 826 670 358 817 71 2000 633 1427 141 1370 610 1686 2015 1079 374 1607 1058 210 455 1519 1741 1706 97 1567 18 321 751 950 383 426 1464 1181 410 774 914 1884 1542 559 1515 913 1339 489 1590 1704 648 1273 153 1286 16 1132 1509 1334 1920 1406 988 591 339 40 1616 1547 1995 409 361 49 1808 46 149 1991 643 1212 1378 1983 1462 131 943 1693 516 886 1139 395 1646 1497 960 937 208 392 116 172 1688 1953 991 319 797 1039 587 218 459 578 1226 1483 1161 1377 1384 202 1933 1114 1910 1872 1781 284 1453 974 460 250 2001 1485 1489 901 746 77 262 620 1046 1737 68 558 772 582 590 1320 1518 1351 2047 25 498 867 1729 1250 1440 768 1621 110 296 499 477 1189 390 379 174 1094 2029 523 1346 2003 1182 1754 660 80 193 1450 188 907 421 628 483 450 1178 971 1041 1417 422 528 1246 968 127 2025 256 1190 1658 1472 292 663 1049 234 38 613 370 171 1484 1654 726 121 900 1302 103 731 967 196 243 1078 833 1540 1570 1748 811 561 2022 1471 1056 1331 1144 1067 1618 1086 1768 506 247 1853 12 20 2032 1634 2002 1786 729 101 515 691 1498 1392 1036 1636 1142 658 1784 1096 1297 279 1092 1845 1549 1705 1324 1651 1997 838 625 1822 1454 1835 1085 548 1022 1460 806 241 1431 1357 520 571 759 1605 659 1187 1925 1054 655 389 1271 631 1276 2009 137 2038 1411 1743 551 757 710 812 1536 496 1592 799 1064 706 822 783 217 1716 921 1430 212 1674 1480 1602 902 133 1841 807 468 281 1571 665 959 722 701 57 637 2034 1889 1282 1451 8 911 1342 952 471 1496 1903 1820 1934 742 1359 470 644 1722 1408 413 1256 1007 1776 189 1735 531 41 1864 1420 216 1624 1817 1979 905 1176 895 1721 1932 1632 635 1899 1395 1804 1247 969 1216 1657 941 425 2024 1728 529 664 442 1513 711 1037 1802 1870 1512 1833 970 1947 1949 356 1452 1168 306 707 906 1900 1074 179 852 608 452 1772 267 640 1502 1108 1739 1628 1222 764 406 1230 253 2041 944 993 122 139 1336 720 266 2021 1617 694 1763 294 1988 758 1381 1348 467 605 456 472 48 1396 76 363 1449 2043 148 1648 813 1901 66 1255 1463 1711 1521 1985 965 104 656 1969 1681 840 1081 151 268 1307 1926 1909 1098 1912 1213 232 606 1610 1236 441 2044 235 932 545 920 1429 1164 1798 818 115 1076 733 447 1345 89 697 933 307 444 168 417 1083 1637 1349 1360 1150 568 1488 1289 1446 1522 1308 1469 1158 1323 1873 596 1071 873 158 1013 400 1501 935 1790 211 602 623 1545 84 723 1391 1986 2004 1195 997 1459 510 808 123 1040 1832 1136 274 476 474 1123 639 11 634 1530 1341 1476 924 1744 1211 1248 862 320 1330 1838 1935 1204 384 415 1539 1863 1154 1316 961 182 1796 1860 1280 1914 1137 1961 1733 1846 304 1043 29 1676 167 420 482 576 1080 1145 1350 903 1834 1861 654 248 497 1882 1179 1660 1018 161 377 1663 2040 1580 984 1750 1416 316 1262 536 22 1317 191 416 1756 1869 254 1561 434 1921 457 330 1707 152 622 1996 2023 344 618 1278 1198 899 120 162 981 1696 1780 524 1713 1906 539 836 1874 302 780 809 1687 1337 1598 494 1473 419 272 1904 1099 1103 1264 1166 1066 978 537 1879 1030 615 105 1069 549 820 1362 1764 108 609 1063 930 1295 2027 1397 541 291 1208 1354 563 617 542 59 649 458 1333 2007 386 1468 1993 801 236 585 1915 98 1896 963 791 399 1668 1699 1202 1148 1829 973 669 2010 351 1529 288 752 917 532 1495 245 1290 99 824 1557 1466 705 473 692 1678 175 855 957 154 1219 668 1157 2050 712 360 504 1765 735 432 221 1227 986 505 15 556 1209 1075 700 199 956 597 887 1770 946 925 1404 112 408 1465 1027 270 2013 1021 1011 1291 491 349 428 130 313 1447 747 163 1823 517 440 331 1851 636 462 1055 1070 134 1162 1865 1068 1719 362 1877 1830 866 740 1122 1358 518 1640 1555 1788 1611 1591 1984 1191 1251 1523 876 819 289 1918 1048 490 1978 1994 1372 1077 1237 1313 1047 1457 1374 1239 1940 276 926 1260 1258 1393 230 588 1774 1755 287 690 966 530 1105 1553 1837 922 23 324 661 1126 51 1692 355 1562 513 86 1409 301 1667 893 1537 879 1111 1379 55 1527 1550 228 589 1799 1371 521 1968 1608 1281 1130 1299 1866 205 1304 1155 1000 1020 1305 546 708 2020 507 1170 798 1112 52 1842 1514 732 881 10 688 303 26 53 948 1977 1998 999 1703 871 323 424 1685 1025 1890 1919 1017 1762 595 1566 962 1773 111 793 1206 35 574 1626 677 1243 1976 1572 1758 1843 1505 672 113 1014 1794 756 771 398 721 252 1012 1387 502 1159 1962 1478 987 794 1147 1793 1031 1042 159 1265 646 1641 1244 992 207 342 343 1740 878 194 745 39 286 1456 192 1418 1001 612 327 373 1003 322 734 1235 1443 1174 1175 857 2045 1366 1084 1931 810 1718 1481 877 533 393 1895 856 2 1228 1980 106 1257 1941 766 1120 338 699 1715 860 446 845 1165 92 2036 1517 45 1695 544 832 1805 716 1415 1240 178 1543 255 31 381 13 466 1862 684 951 265 1275 1045 142 1146 1689 369 682 996 1635 305 1944 714 1487 79 1575 1679 17 1852 282 1670 555 165 453 1886 346 144 1188 627 611 834 129 1110 1625 1734 449 1960 1546 1005 904 851 1373 1089 249 1584 238 1599 616 1026 1494 1051 295 538 1259 1950 1854 503 572 939 687 675 1631 1907 1326 717 958 1493 1891 1203 311 69 170 1073 1232 6 1992 1712 1306 786 1554 1134 1044 181 427 1974 445 1433 1312 2039 1425 1298 1087 114 522 1885 1516 1745 1916 1803 293 1690 1319 594 2006 955 964 33 65 1382 443 96 1883 1633 368 657 124 1836 1813 760 776 865 785 674 744 335 1510 201 1180 1819 550 1422 1245 936 1225 1153 1880 251 1816 1445 1050 501 552 464 1929 553 927 931 1942 156 488 1579 804 1325 875 841 366 1172 2042 666 1220 480 1303 713 1751 839 667 454 1010 1792 929 1604 1254 1461 1601 2026 889 312 1612 1375 380 1556 898 1807 1619 547 653 1293 1613 1908 109 1186 2033 565 1224 1365 1385 645 761 1486 847 382 737 200 849 1285 1581 64 329 1548 190 186 1008 1102 1717 864 1287 1499 2017 1263 1655 1353 128 198 1439 1828 42 1482 1059 197 1296 719 1231 1528 411 1455 1959 916 1314 1388 1782 842 1097 1399 1795 372 579 277 354 237 1691 1491 347 680 225 1787 953 894 436 336 375 1091 95 340 586 1659 223 816 78 258 1438 1367 73 1726 821 391 1559 1072 184 1135 385 1752 367 147 598 1434 30 979 44 495 1987 1109 621 1268 378 353 1016 394 1649 1749 1156 769 1639 1576 275 861 592 1352 1163 883 1199 642 1034 183 749 67 242 187 1898 652 1223 1956 593 1184 1814 1121 1402 493 1927 1310 782 1855 1783 261 1928 1923 1138 1840 32 273 61 27 1143 1269 854 451 954 233 1622 1432 540 994 827 562 888 1881 244 423 1627 570 1964 1970 1702 1492 1413 1746 1436 1060 414 1825 1568 802 1975 439 790 1583 222 318 915 437 1088 1477 698 1532 1504 164 2011 1672 350 934 314 1600 1710 890 1897 1115 519 584 2031 431 1937 1809 1152 1847 784 257 136 1410 909 535 1019 1603 407 1221 870 326 828 1328 662 1386 1552 1266 1405 696 1361 388 1742 203 226 1771 1775 180 823 348 1508 1167 844 683 58 1697 830 176 412 1766 1169 566 239 215 526 214 858 1922 543 651 647 1732 1401 910 1394 1594 1183 1779 1615 138 1946 143 527 1403 213 62 1424 1151 1645 2049 601 1952 1955 1859 891 604 1958 478 1565 1535 479 1192];
    
    for i=1:1:numero_bits_erroneos
            value = txBitsEncodedInterleaved(randomPos(i));
            if value == 0
                txBitsEncodedInterleaved2(randomPos(i))=1; % Si es un 0 le ponemos 1
            elseif value == 1
                txBitsEncodedInterleaved2(randomPos(i))=0; % Si es un 1 le ponemos 0
            else 
                txBitsEncodedInterleaved2(randomPos(i))=txBitsEncodedInterleaved(randomPos(i)); % Lo dejamos igual
            end
    end
    
    else 
    randomPos = [271 384 1881 1572 880 1731 17 1437 2003 555 905 1340 1085 1641 756 324 1460 818 1205 382 1303 1135 178 1835 743 781 2063 1888 954 1187 101 1043 342 1230 2061 2015 1123 1394 1371 1638 1917 1852 760 1967 636 1674 1941 542 1251 1503 267 1839 727 263 1584 136 2044 1153 487 816 838 763 288 1995 1252 1757 1337 345 1853 1463 1686 1949 390 579 1516 1947 349 516 620 744 495 10 639 181 1299 1890 245 1934 276 473 1373 356 619 722 1882 235 582 43 767 1573 764 1764 789 1718 1783 183 697 1755 1272 1826 623 520 378 1136 1151 219 1678 1601 1904 887 282 1504 1147 330 400 1141 40 1032 177 719 759 1466 1334 911 1806 1523 1369 1668 510 1608 251 1409 944 784 796 1242 804 394 1661 1199 413 946 1364 214 1961 71 333 138 1578 1015 120 593 837 1875 1925 149 285 422 2010 1650 1802 1715 268 625 1221 574 385 1818 210 709 1005 903 1591 503 1752 1167 1164 1134 417 1231 923 1598 846 122 30 1538 841 1266 1256 857 1744 1233 1389 1916 1816 1218 24 1243 280 1288 2012 50 441 615 514 1002 1565 741 1453 112 1211 1580 1348 218 702 952 264 1756 1510 1527 689 29 1144 1694 336 725 2052 1861 707 1358 1924 1277 692 1920 1729 1279 1524 412 1730 561 99 1803 292 1323 1257 1296 1946 666 45 1450 1003 1192 1193 1618 207 1403 1055 2051 1092 1765 481 1042 2047 1972 1163 428 187 1677 1712 1863 788 1667 698 1375 920 682 534 672 785 1074 1307 1644 1322 1869 983 1399 1162 1827 1026 1787 1133 110 1594 304 1105 926 132 1269 1670 646 658 1537 1983 300 1353 1068 771 1676 1097 51 81 415 1799 1122 28 871 676 750 244 174 176 686 1954 179 432 884 317 1052 1546 1331 732 1777 1528 1804 277 266 1393 1736 240 928 34 489 1798 1355 436 154 1634 904 1671 1648 1831 278 452 340 58 1368 1235 371 1548 111 320 286 1426 972 728 195 685 1035 221 2050 96 1115 142 606 792 547 1209 605 1255 825 1699 299 125 1398 634 583 633 831 1911 192 1566 1301 1878 1621 1713 1202 1378 1142 1326 1629 665 1073 151 498 987 260 1859 257 11 729 933 358 65 1101 1232 915 1091 409 1849 1975 1131 279 354 91 1556 39 66 289 852 648 1982 1991 793 1474 31 1014 389 22 450 618 1575 528 456 659 1959 1225 726 1226 1487 997 1515 1249 1432 569 229 733 164 494 754 376 1701 694 537 1893 239 1899 424 318 1086 568 588 1018 918 226 1222 1435 2024 1006 578 1467 896 1828 321 1732 557 1582 209 1529 1339 529 1140 768 1118 451 981 1688 2058 703 1945 193 874 1427 259 613 411 1024 1265 1374 197 16 1693 517 68 381 1706 758 1037 820 1725 1352 1344 1976 460 482 786 932 1971 700 485 1239 483 2014 968 1206 457 1391 234 653 723 1431 1103 834 1457 1837 1469 1769 663 598 303 644 6 1130 78 27 844 1327 161 455 657 1238 585 513 79 1809 1185 994 2070 1028 269 1183 1013 1593 1885 2002 152 1953 1781 1914 493 1508 1997 1989 695 1753 566 626 1981 172 1586 907 683 1956 462 1748 1443 749 1841 1867 855 1872 109 1900 511 1785 1308 472 934 1330 1034 1866 1180 2019 1093 2022 910 1847 1873 1773 2066 1445 1430 190 960 242 1385 1576 731 1738 1282 35 1343 883 365 1822 671 3 275 2004 325 1107 704 1709 1740 1421 1 1623 2046 131 89 431 1000 1190 265 1793 1370 629 42 1772 296 1984 1053 1284 1743 366 1072 1017 1654 1762 469 189 1700 649 1361 337 2065 790 821 1152 1342 1315 253 800 1820 383 1767 518 1060 587 1784 734 1490 1186 632 119 37 908 1156 1912 367 1137 839 1254 387 929 106 496 863 1642 62 1049 895 1950 1227 674 129 490 124 1637 567 1887 310 1212 1966 1210 61 328 2001 225 1341 661 1168 597 464 966 12 316 1290 395 1317 77 1111 130 868 805 433 1161 1663 1895 1057 398 525 677 1643 1388 888 1500 1808 617 1346 1104 1921 143 1913 1411 881 18 1120 1652 930 770 1328 1096 802 1289 8 274 706 713 1628 1387 1250 1007 1302 1145 645 1267 1025 1726 1195 1672 1891 1011 917 427 621 660 1220 350 1081 1188 1176 1763 315 1138 548 1441 1497 329 1525 92 794 1512 1915 877 530 693 2067 446 137 2045 421 233 2033 979 989 1108 186 167 2038 1850 1613 1791 985 1182 667 1691 931 748 773 1564 1884 1313 1020 627 1801 967 230 635 1969 1511 401 1246 406 1838 1935 127 978 565 1550 370 1892 80 1280 1489 375 536 959 144 1615 438 850 1365 1812 1843 836 126 402 791 927 445 691 882 1660 83 1067 738 369 1012 1094 1569 1173 423 141 1625 1234 1332 559 1617 602 1397 553 1475 1030 1968 1274 1045 1126 331 1258 1606 1692 650 1106 480 14 360 1228 171 1722 355 2064 975 869 1476 1776 185 211 824 258 533 500 563 1271 687 1994 512 1711 1059 1415 362 293 1955 740 1534 948 1536 902 1350 1357 1498 1858 13 1993 2040 549 169 832 949 1879 1248 842 1669 519 1360 1585 1834 1932 783 562 175 227 955 1998 765 833 527 1710 232 611 705 1244 797 463 1281 798 145 437 1683 1897 1477 191 213 506 1064 962 1382 160 1494 147 581 1651 1851 1719 761 862 1349 1571 59 1198 772 1631 135 889 374 909 724 1300 1987 2054 1089 1542 815 1960 1690 1560 306 1619 1401 2049 1622 410 335 608 1041 1737 696 1933 118 2 1400 1794 2006 1842 973 912 541 115 717 26 2021 1614 471 1058 747 281 813 1951 1870 220 762 1470 939 1860 1632 1247 1846 348 1484 808 1745 1543 1114 2048 117 1216 1780 1196 1696 307 116 1901 1559 900 596 373 1749 969 388 49 1384 1746 1627 575 1513 642 1788 1549 404 158 1647 1324 556 664 655 1194 1944 2069 2026 1539 1978 203 105 535 162 182 305 238 811 1294 102 283 1616 247 673 1021 1877 1666 1927 326 829 1856 323 107 1165 497 250 1471 601 1491 484 255 476 1351 1659 872 848 1836 1742 2057 1377 1449 1260 1178 1347 977 205 201 1047 408 339 1962 1033 1926 146 228 2013 795 1928 1599 1128 2060 1514 1656 1747 974 1314 1880 1682 616 766 573 188 173 352 2028 1519 153 403 539 2062 67 1428 550 1988 630 1517 1909 429 1903 1985 1395 248 1446 827 1680 746 113 1770 690 1795 1570 526 353 1771 54 60 778 1418 1082 993 652 752 1436 925 1191 86 1207 166 1728 1050 1646 2056 1429 1857 1125 1754 1544 1154 1907 906 963 715 467 224 1817 1603 1778 897 1923 755 502 1268 552 1815 580 1031 1948 885 168 1592 155 668 1664 1626 312 439 486 47 919 1159 397 736 1148 1273 1383 1390 1844 540 1992 849 1751 1027 53 1789 1501 222 875 2011 876 1906 426 814 1219 1278 114 1782 1480 1310 684 70 94 150 1653 123 64 459 199 688 976 787 612 891 44 1261 1684 1602 735 405 757 840 1999 380 108 1797 1204 1367 361 319 1039 1741 1554 1433 1965 1703 1420 1459 1620 23 532 866 1090 508 478 1821 434 347 1577 1116 1304 1759 1810 15 1922 1320 236 1062 1796 470 1462 1552 637 1038 643 1830 879 1319 418 1270 1291 2020 1127 1019 140 477 364 1805 32 507 1110 523 721 1496 1507 998 1051 1721 1079 1848 801 1404 1624 1541 194 1727 1716 890 103 947 1488 93 237 2005 662 5 1657 775 1112 165 1665 1520 1362 1008 1705 1963 950 1919 1004 878 1655 1071 454 1819 85 1938 1883 1408 1568 1456 82 241 509 586 392 1146 1662 812 170 1587 835 610 1540 1472 1864 1171 1419 1372 447 1376 1486 1224 1121 1354 1048 1312 294 1723 73 1547 1952 55 1929 1786 121 1604 572 1931 867 416 75 640 1321 468 1986 1588 1184 886 1553 1902 2053 46 843 298 1100 1708 1095 1611 1158 1454 1061 297 2017 769 1287 461 819 1166 322 980 196 742 1535 577 590 1990 1792 1417 74 1203 654 100 854 1099 1658 1179 751 779 346 1679 546 313 1761 678 861 163 1170 273 1392 287 1704 2009 1600 1444 1461 284 810 69 609 1245 139 261 515 1485 1545 560 2034 1739 1413 2041 1065 913 894 604 921 1530 1070 712 675 57 1149 1942 206 1325 1381 1438 1482 647 351 745 1083 1465 332 1896 1356 937 1522 231 1172 1117 1845 860 184 1451 2031 1493 1066 1406 1707 254 2055 1380 1639 2018 1155 1215 200 1139 2042 1263 1595 1345 737 1316 1717 504 1840 669 128 97 1714 901 1022 1197 543 1702 916 1189 1237 2043 710 419 656 1473 2037 1698 942 531 1213 1109 217 435 357 465 984 1832 1567 1046 25 599 1800 157 2000 1908 1119 708 971 1412 1259 1298 803 1483 777 1583 822 1518 301 21 38 603 999 1124 363 1440 499 1241 1040 52 964 1557 1645 1379 1829 1359 1363 212 1208 36 544 443 1414 1174 262 899 1724 554 33 1551 592 56 1492 1597 1855 2016 311 204 407 753 990 1468 864 491 1253 1774 970 1422 84 1605 215 1366 1720 538 809 2059 1056 1075 986 865 309 584 898 2007 628 430 1533 1760 1113 1160 474 134 1689 180 1478 817 458 1957 799 223 1236 591 1076 133 202 4 1499 570 9 440 679 1084 1396 859 1442 1562 1029 2027 1581 1977 1886 1132 1970 1811 1181 488 1610 1531 453 1758 148 19 651 76 442 551 1596 847 314 1905 104 1078 571 1240 90 1402 945 1854 641 1681 1309 1865 1734 249 1229 7 1283 1814 823 680 1295 1150 1779 1823 501 1169 1768 377 1458 1685 1532 1824 961 396 1936 420 873 1590 425 1733 1894 681 1143 1201 996 730 828 1088 1306 858 826 308 208 391 870 1264 1338 851 466 701 1044 256 631 614 492 393 1563 711 576 1630 379 1937 806 1687 922 951 334 1974 1311 1807 1335 558 1223 1558 1973 48 1262 291 1505 1574 1506 1069 1452 41 953 670 1813 2039 1876 372 1930 1054 892 1940 607 1455 622 594 479 1318 1214 1825 589 1009 714 893 1479 344 545 853 1868 243 1425 1833 1434 992 1423 272 368 2008 1735 1405 1640 782 1410 338 1633 1200 1129 1293 830 720 1329 1561 1898 1333 1750 1766 1918 1874 1675 295 1010 198 444 774 1589 624 87 1292 1526 699 1102 1016 1612 1424 924 638 98 807 1609 1502 780 956 2068 1036 595 943 718 156 1636 1386 1790 941 2025 1285 1980 995 159 341 1407 600 270 2036 2029 343 1448 1509 1910 1305 386 246 1495 290 1063 521 1635 1649 1579 1077 1996 936 2023 982 2035 1297 72 302 1889 63 448 988 776 1276 1157 449 252 1275 856 1447 914 1979 1177 2030 957 359 716 1416 1862 1481 1964 1286 1023 1175 1607 1697 1439 938 1336 991 1958 739 2032 524 1080 95 1943 505 1098 1464 1001 216 20 1939 1555 958 845 1695 935 965 475 564 1217 1673 414 88 1871 399 1775 1087 327 1521 522 940];
    for i=1:1:numero_bits_erroneos
            value = txBitsEncodedInterleaved(randomPos(i));
            if value == 0
                txBitsEncodedInterleaved2(randomPos(i))=1; % Si es un 0 le ponemos 1
            elseif value == 1
                txBitsEncodedInterleaved2(randomPos(i))=0; % Si es un 1 le ponemos 0
            else 
                txBitsEncodedInterleaved2(randomPos(i))=txBitsEncodedInterleaved(randomPos(i)); % Lo dejamos igual
            end
    end
    end
rxBitsError = txBitsEncodedInterleaved2;


%if strcmp(rafaga,'no') 
%for i = 1:round(length(txBitsEncodedInterleaved)/numero_bits_erroneos):length(txBitsEncodedInterleaved)
%     if txBitsEncodedInterleaved(i)== 0
%         txBitsEncodedInterleaved2(i)=1;
%     else 
%         txBitsEncodedInterleaved2(i)=0;
%     end
%end
%rxBitsError = txBitsEncodedInterleaved2;

else
    for i = 1:floor(length(txBitsEncodedInterleaved)/(numero_rafagas)):(length(txBitsEncodedInterleaved)-1)
        %Este metodo esta creado para meter solamente rafagas de ceros
        %txBitsEncodedInterleaved2(i:i+floor(numero_bits_erroneos/numero_rafagas))=0;
        
        %Este metodo introduce rafagas de errores completos
        for j = 1:1:((floor(numero_bits_erroneos/numero_rafagas)-2))
            if txBitsEncodedInterleaved(i+(j-1))== 0
                txBitsEncodedInterleaved2(i+(j-1))=1;
            else 
                txBitsEncodedInterleaved2(i+(j-1))=0;
            end  
        end
    end
txBitsEncodedInterleaved3(1:length(txBitsEncodedInterleaved))= txBitsEncodedInterleaved2(1:length(txBitsEncodedInterleaved));
rxBitsError = txBitsEncodedInterleaved3;
end

%Cambiar por dos para aleatorios
